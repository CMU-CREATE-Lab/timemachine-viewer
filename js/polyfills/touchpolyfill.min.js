/**
 * @license
 * (The MIT License)
 *
 * Copyright (c) 2015 Cameron Henlin
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 */
(function(){function u(){var b=[];this.touchList=b;this.Touch=function(a,b,d,e,f,g,l,h){this.identifier=a;this.target=b;this.screenX=d;this.screenY=e;this.clientX=f;this.clientY=g;this.pageX=l;this.pageY=h};this.getTouch=function(a){var c;for(c=0;c<b.length;c+=1)if(b[c].identifier===a)return b[c]};this.addUpdateTouch=function(a){var c;for(c=0;c<b.length;c+=1)if(b[c].identifier===a.identifier){b[c]=a;return}b.push(a)};this.removeTouch=function(a){var c;for(c=0;c<b.length;c+=1)b[c].identifier===a&&
b.splice(c,1)};this.clearTouches=function(){for(;0<b.length;)b.pop()};this.containsTouchAt=function(a,c){var d;for(d=0;d<b.length;d+=1)if(b[d].screenX===a&&b[d].screenY===c)return!0;return!1}}function q(b,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,a.bubbles,a.cancelable,a.detail);return c}function k(b,a,c,d,e){function f(b,a){var c;r.clearTouches();for(c=0;c<a.length;c++){var m=a[c];m.target.isSameNode(b)&&r.addUpdateTouch(m)}}function n(a){if("pointerdown"===
a.type)var b="touchstart";else if("pointermove"===a.type)b="touchmove";else throw Error("touchHandler received invalid event type: "+b+". Valid event types are pointerdown and pointermove");var c=new g.Touch(a.pointerId,"pointerdown"===a.type?a.target:k,a.screenX,a.screenY,a.clientX,a.clientY,a.pageX,a.pageY);"undefined"===typeof a.hwTimestamp&&(a.hwTimestamp=a.timeStamp);if(a.hwTimestamp>v){var d,m;var e=l.touchList;for(d=0;d<e.length;d+=1){var n=e[d];var h=n.identifier;(m=g.getTouch(h))&&(m.screenX!==
n.screenX||m.screenY!==n.screenY)||l.removeTouch(h)}}g.addUpdateTouch(c);l.addUpdateTouch(c);f(c.target,g.touchList);a.type=b;a=new q(b,{bubbles:!0,cancelable:!0});a.touches=g.touchList;a.changedTouches=l.touchList;a.targetTouches=r.touchList;a.type=b;return a}function h(a){var b;a.changedTouches=[];a.changedTouches.length=1;a.changedTouches[0]=a;a.changedTouches[0].identifier=a.pointerId;"pointerup"===a.type?b="touchend":"pointercancel"===a.type?b="touchcancel":"pointerleave"===a.type&&(b="touchleave");
var c=new g.Touch(a.pointerId,k,a.screenX,a.screenY,a.clientX,a.clientY,a.pageX,a.pageY);"undefined"===typeof a.hwTimestamp&&(a.hwTimestamp=a.timeStamp);a.hwTimestamp>v&&l.clearTouches();g.removeTouch(c.identifier);l.addUpdateTouch(c);f(c.target,g.touchList);a.type=b;a=new q(b,{bubbles:!0,cancelable:!0});a.touches=g.touchList;a.changedTouches=l.touchList;a.targetTouches=r.touchList;a.type=b;return a}if("pointerdown"!==b.type){a=g.getTouch(b.pointerId);var k=a.target;b.target=k}a="pointerdown"===b.type||
"pointermove"===b.type?n(b):h(b);a.preventDefault=function(){void 0!==b.preventDefault&&b.preventDefault()};b.target.dispatchEvent(a);"undefined"===typeof event.hwTimestamp&&(event.hwTimestamp=event.timeStamp);v=event.hwTimestamp}function A(b,a,c,d){void 0===b.__handJobjsRegisteredEvents&&(b.__handJobjsRegisteredEvents=[]);if(d)void 0!==b.__handJobjsRegisteredEvents[a]?b.__handJobjsRegisteredEvents[a]+=1:(b.__handJobjsRegisteredEvents[a]=1,b.addEventListener(a,c,!1));else{if(-1!==b.__handJobjsRegisteredEvents.indexOf(a)&&
(--b.__handJobjsRegisteredEvents[a],0!==b.__handJobjsRegisteredEvents[a]))return;b.removeEventListener(a,c);b.__handJobjsRegisteredEvents[a]=0}}function B(b,a,c){b.__handJobjsGlobalRegisteredEvents||(b.__handJobjsGlobalRegisteredEvents=[]);if(c){if(void 0!==b.__handJobjsGlobalRegisteredEvents[a]){b.__handJobjsGlobalRegisteredEvents[a]+=1;return}b.__handJobjsGlobalRegisteredEvents[a]=1}else void 0!==b.__handJobjsGlobalRegisteredEvents[a]&&(--b.__handJobjsGlobalRegisteredEvents[a],0>b.__handJobjsGlobalRegisteredEvents[a]&&
(b.__handJobjsGlobalRegisteredEvents[a]=0));void 0!==b["on"+a.toLowerCase()]&&A(b,a,function(b){k(b,a)},c)}function e(b){function a(a,b,e){-1!==x.indexOf(a)&&B(this,a,!0);c.call(this,a,b,e)}var c=b.prototype?b.prototype.addEventListener:b.addEventListener;b.prototype?b.prototype.addEventListener=a:b.addEventListener=a}function t(b,a){b.preventManipulation&&b.preventManipulation();k(touchPoint,a)}function C(b,a){if(void 0===b.ontouchdown&&void 0!==b.ontouchstart)switch(a.toLowerCase()){case "touchstart":b.removeEventListener("pointerdown",
function(b){t(b,a)});break;case "touchmove":b.removeEventListener("pointermove",function(b){t(b,a)});break;case "touchend":b.removeEventListener("pointerup",function(b){t(b,a)});break;case "touchcancel":b.removeEventListener("pointercancel",function(b){t(b,a)})}}function f(b){function a(a,b,e){-1!==x.indexOf(a)&&C(this,a);c.call(this,a,b,e)}var c=b.prototype?b.prototype.removeEventListener:b.removeEventListener;b.prototype?b.prototype.removeEventListener=a:b.removeEventListener=a}function p(b,a,c,
d,e,f){for(d=c;d&&(!d.__handJobjsGlobalRegisteredEvents||!d.__handJobjsGlobalRegisteredEvents[b]);)d=d.parentNode;d=d?d:window.__handJobjsGlobalRegisteredEvents&&window.__handJobjsGlobalRegisteredEvents[b]?window:void 0;d&&k(a,b,e,c,f)}function y(b){var a=[];if(b)for(a.unshift(b);b.parentNode;)a.unshift(b.parentNode),b=b.parentNode;return a}function z(b,a){for(var c=y(b),d=y(a),e=null;0<c.length&&c[0]===d.shift();)e=c.shift();return e}function D(b,a,c){a=z(b,a);for(var d=[];b&&b!==a;)b.__handJobjsGlobalRegisteredEvents&&
b.__handJobjsGlobalRegisteredEvents.touchenter&&d.push(b),b=b.parentNode;for(;0<d.length;)c(d.pop())}function E(b,a,c){for(a=z(b,a);b&&b!==a;)b.__handJobjsGlobalRegisteredEvents&&b.__handJobjsGlobalRegisteredEvents.touchleave&&c(b),b=b.parentNode}var v=0,h=navigator.userAgent,x=["touchstart","touchmove","touchend","touchcancel","touchleave"],w={};q.prototype=window.Event.prototype;if("object"!==typeof window.ontouchstart&&!(h.match(/iPad/i)||h.match(/iPhone/i)||h.match(/iPod/i)||h.match(/Android/i)||
h.match(/MSIE/i)&&!h.match(/Touch/i))){(function(){var b=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css";a.styleSheet?a.styleSheet.cssText="html { -ms-touch-action: none; }":a.appendChild(document.createTextNode("html { -ms-touch-action: none; }"));b.appendChild(a)})();var g=new u;var l=new u;var r=new u;window.CustomEvent=q;e(window);e(window.HTMLElement||window.Element);e(document);e(HTMLBodyElement);e(HTMLDivElement);e(HTMLImageElement);
e(HTMLUListElement);e(HTMLAnchorElement);e(HTMLLIElement);e(HTMLTableElement);window.HTMLSpanElement&&e(HTMLSpanElement);window.HTMLCanvasElement&&e(HTMLCanvasElement);window.SVGElement&&e(SVGElement);f(window);f(window.HTMLElement||window.Element);f(document);f(HTMLBodyElement);f(HTMLDivElement);f(HTMLImageElement);f(HTMLUListElement);f(HTMLAnchorElement);f(HTMLLIElement);f(HTMLTableElement);window.HTMLSpanElement&&f(HTMLSpanElement);window.HTMLCanvasElement&&f(HTMLCanvasElement);window.SVGElement&&
f(SVGElement);(function(){function b(a){return"mouse"===a.pointerType||"pointerdown"===a.type&&0===a.x&&0===a.y||"pen"===a.pointerType&&0===a.pressure&&"pointermove"===a.type?!0:!1}"undefined"===typeof window.TouchEvent&&(window.addEventListener("pointerdown",function(a){b(a)||(w[a.identifier]=a.target,p("touchenter",a,a.target,a,!0),D(a.target,null,function(b){k(a,"touchenter",!1,b,void 0)}),p("touchstart",a,a.target,a,!0))}),window.addEventListener("pointerup",function(a){var c=w[a.identifier];
b(a)||(p("touchend",a,c,a,!0),p("touchleave",a,c,a,!0),E(c,null,function(b){k(a,"touchleave",!1,b,void 0)}))}),window.addEventListener("pointermove",function(a){var c=w[a.identifier];if(!b(a)&&!g.containsTouchAt(a.screenX,a.screenY)){var d;if(d=c){for(d=c;d&&!d.handJobjs_forcePreventDefault;)d=d.parentNode;d=!0===(!!d||window.handJobjs_forcePreventDefault)}d&&a.preventDefault();p("touchmove",a,c,a,!0)}}))})()}})();
