<html>
<head>
   <title>Timelapse GigaPan</title>
   <style type="text/css">
      body, p, table, tr, td, span, div {
         font-family: Helvetica, sans-serif;
      }

      h1 {
         text-align: center;
      }

      .subtitle {
         font-weight:bold;
      }
   </style>
   <script src="js/jquery/jquery.min.js" type="text/javascript"></script>
   <script src="js/org/gigapan/util.js" type="text/javascript"></script>
   <script type="text/javascript">
      // Test whether this is being served from timelapse.gigapan.org.  If so, then fetch the JSON from there too.
      // If not, then assume it's being served from localhost and fetch the JSON from the local machine (since we're
      // not using JSONP on timelapse.gigapan.org (but we probably should!)).
      var urlMatchPattern = /^http:\/\/timelapse.gigapan.org\//;
      var isRemoteUrl = window.location.href.match(urlMatchPattern) != null;

      function loadDatasets(collectionId, gigapanId)
         {
         var jsonUrl = (isRemoteUrl ? "../alpha/timelapses/" : "../timelapses/") + gigapanId + '.json';
         org.gigapan.Util.log("Attempting to fetch gigapan datasets JSON from URL [" + jsonUrl + "]...");
         $.ajax({
                   dataType:'json',
                   url: jsonUrl,
                   success: function(gigapanDatasetsJSON)
                      {
                      if (gigapanDatasetsJSON && gigapanDatasetsJSON['base-id'] == gigapanId && gigapanDatasetsJSON['datasets'] && gigapanDatasetsJSON['datasets'].length > 0)
                         {
                         org.gigapan.Util.log("Loaded this JSON: [" + JSON.stringify(gigapanDatasetsJSON) + "]");

                         // now populate the Viewer Size popup menu with the various datasets
                         $(collectionId).empty();
                         for (var i = 0; i < gigapanDatasetsJSON['datasets'].length; i++)
                            {
                            $(collectionId).append('<li><a href="timelapse.html?id='+gigapanId+'&dataset='+i+'">' + gigapanDatasetsJSON['datasets'][i]['id'] + ' ' + gigapanDatasetsJSON['datasets'][i]['name'] + '<a/></li>');
                            }
                         }
                      else
                         {
                         org.gigapan.Util.error("Failed to load gigapan datasets json from URL [" + jsonUrl + "]");
                         }
                      },
                   error: function()
                      {
                      org.gigapan.Util.error("Error loading gigapan datasets json from URL [" + jsonUrl + "]");
                      }
                });
         }

      $(document).ready(function()
                           {
                           loadDatasets('#carnival_datasets', 'carnival-10m-halfsize-g10-bf0-l30');
                           loadDatasets('#brassica_datasets', 'brassica-15m-halfsize-g10-bf0-l15');
                           loadDatasets('#kraus_datasets', 'ghc1-24h-halfsize-crf32-g10-bf0-l30');
                           loadDatasets('#visiblehuman_datasets', 'vh-3mm-crf30-g10-bf0-l30');
                           });
   </script>
</head>
<body>
<h1>Timelapse GigaPan</h1>
<span class="subtitle">Carnival</span>
<ul id="carnival_datasets">
   <li>loading...</li>
</ul>
<span class="subtitle">Brassica</span>
<ul id="brassica_datasets">
   <li>loading...</li>
</ul>
<span class="subtitle">Krause Winter Garden</span>
<ul id="kraus_datasets">
   <li>loading...</li>
</ul>
<span class="subtitle">Visible Human Female</span>
<ul id="visiblehuman_datasets">
   <li>loading...</li>
</ul>
<!--
<span class="subtitle">Old (won't work)</span>
<ul>
   <li><a href="timelapse.html?id=brassica-15m-halfsize-384-10fps">brassica-15m-halfsize-384-10fps</a></li>
   <li><a href="timelapse.html?id=brassica1-15m-halfsize">brassica1-15m-halfsize</a></li>
   <li><a href="timelapse.html?id=brassica1-15m-halfsize-10fps">brassica1-15m-halfsize-10fps</a></li>
   <li><a href="timelapse.html?id=brassica1-15m-halfsize-384-nb">brassica1-15m-halfsize-384-nb</a></li>
   <li><a href="timelapse.html?id=brassica1-15m-halfsize-512-10fps">brassica1-15m-halfsize-512-10fps</a></li>
   <li><a href="timelapse.html?id=brassica1-15m-halfsize-nb">brassica1-15m-halfsize-nb</a></li>
   <li><a href="timelapse.html?id=brassica1-1h-halfsize">brassica1-1h-halfsize</a></li>
   <li><a href="timelapse.html?id=brassica1-4h-halfsize">brassica1-4h-halfsize</a></li>
   <li><a href="timelapse.html?id=carnival-10m-halfsize">carnival-10m-halfsize</a></li>
   <li><a href="timelapse.html?id=carnival-10m-halfsize-nb">carnival-10m-halfsize-nb</a></li>
   <li><a href="timelapse.html?id=carnival-20m-halfsize">carnival-20m-halfsize</a></li>
   <li><a href="timelapse.html?id=early-universe1-384">early-universe1-384</a></li>
   <li><a href="timelapse.html?id=early-universe2-512">early-universe2-512</a></li>
   <li><a href="timelapse.html?id=ghc1-24h-halfsize">ghc1-24h-halfsize</a></li>
</ul>
<span class="subtitle">Nichols</span>
<ul>
   <li><a href="timelapse.html?id=nichols1-10m-halfsize">nichols1-10m-halfsize</a></li>
</ul>
<span class="subtitle"> Phipps</span>
<ul>
   <li><a href="timelapse.html?id=phipps1-1h">phipps1-1h</a></li>
</ul>
<span class="subtitle">Visible Human</span>
<ul>
   <li><a href="timelapse.html?id=visible-human-female-256-1mm">visible-human-female-256-1mm</a></li>
   <li><a href="timelapse.html?id=visible-human-female-256-3mm">visible-human-female-256-3mm</a></li>
   <li><a href="timelapse.html?id=visible-human-female-384-1mm">visible-human-female-384-1mm</a></li>
   <li><a href="timelapse.html?id=visible-human-female-384-3mm">visible-human-female-384-3mm</a></li>
   <li><a href="timelapse.html?id=visible-human-female-512-1mm">visible-human-female-512-1mm</a></li>
   <li><a href="timelapse.html?id=visible-human-female-512-3mm">visible-human-female-512-3mm</a></li>
</ul>
-->
</body>
</html>
