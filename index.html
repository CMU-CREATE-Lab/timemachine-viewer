<html>
<head>
   <title>Gigapan Timelapse Explorer</title>
   <script src="js/jquery/jquery.min.js"></script>
   <script src="js/jquery/jquery-ui-1.8.6.custom.min.js"></script>
   <script src="js/jquery/plugins/mouse/jQuery_mousewheel_plugin.js"></script>
   <script src="js/org/gigapan/util.js"></script>
   <script src="js/org/gigapan/timelapse/videoset.js"></script>
   <script src="js/org/gigapan/timelapse/timelapse.js"></script>

   <link href="css/jquery-ui/smoothness/jquery-ui-1.8.6.custom.css" rel="stylesheet" type="text/css"/>
   <style type="text/css">
      body, p, table, tr, td {
         font-family: Verdana, sans-serif;
         font-size: 8pt;
      }

      #timelineSlider {
         margin: 10px;
         width: 500px
      }

      #timelapse {
         cursor: url("css/cursors/openhand.cur")
      }

      #mouse_debug_info {
         border: 1px solid black;
         padding: 3px;
         margin: 3px 0 3px 0;
         width: 500px;
      }

	  .play {
	    width:20;
	    height:23px;
	    background-image: url("images/play.png");
	    cursor: pointer;
	    float:left;
	  }

	  .pause {
		width:20;
	    height:22px;
	    background-image: url("images/pause.png");
	    cursor: pointer;
	    float:left;
	  }

	  .stop {
		width:20;
	    height:22px;
	    background-image: url("images/stop.png");
	    cursor: pointer;
	    float:left;
	  }
   </style>

   <script>
     var timelapseDurationInSeconds = 0.0;
	 var timeStepInSecs = 0.04; // 25 frames per second

     function ready() {
       //  timelapse_load('http://timelapse.gigapan.org/timelapses/visible-human-female-512-3mm/', 'timelapse', 'timelapse_status');
       timelapse_load('../timelapses/brassica1-15m-halfsize/', 'timelapse', 'timelapse_status', {"tile_height":256,"height":3876,"fps":25,"frames":2438,"width":9856,"tile_width":256});
     }
     function keypress() {
       org.gigapan.Util.log('keypress');
     }

	 $(document).ready(function() {
       ready();
	   $(this).keydown(timelapse_handle_keydown);
       $(this).keyup(timelapse_handle_keyup);
	   $(timelapse).mousewheel(timelapse_handle_mousescroll);

	   window.onunload = timelapse_handle_window_close;

	   timelapseDurationInSeconds = g_timelapse.frames/g_timelapse.fps;

	   $("#timelapse").bind("mousemove", function(event) {
	     var viewerPosition = $("#timelapse").position();
		 var mouseX = event.pageX - viewerPosition.left;
		 var mouseY = event.pageY - viewerPosition.top;
		 $("#window_coords").text("(" + event.pageX + "," + event.pageY + ")");
		 $("#viewer_pixel_coords").text("(" + mouseX + "," + mouseY + ")");
	   });

	   $("#timelineSlider").slider({
	     animate: true,
		 value: 0,
		 min: 0,
		 max: timelapseDurationInSeconds,
		 range: "min",
		 step: timeStepInSecs,
		 slide: function(e, ui) {
		   var timeInSecs = ui.value;
		   timelapse_seek(timeInSecs);
		 }
       });

	   $('#play_toggle').bind("click", function() {
	     if ($(this).attr("class") == "play") {
		   $(this).attr("class", "pause");
		   $(this).attr("title","Pause")
		   timelapse_play();
		 } else {
		   $(this).attr("class", "play");
		   $(this).attr("title","Play")
		   timelapse_pause();
		 }
	   });

	   $('#stop').bind("click", function() {
	     $('#play_toggle').attr("class", "play");
	     $('#play_toggle').attr("title","Play")
	     timelapse_seek(0);
	     timelapse_pause();
	   });

	   $("#totalTime").text(timelapse_format_time(timelapseDurationInSeconds));
     });
   </script>
</head>
<body>

<div style="width:800px; height:450px">
   <div id="timelapse" style="position: absolute; width:800px; height:450px; background:black; overflow:hidden">
   </div>
</div>
<div id="timelapse_status"></div>

<input type="button" value="recenter" onclick="timelapse_warp_to(timelapse_home_view())">
<br>
<input type="button" value="rate -1" onclick="timelapse_set_playback_rate(-1)">
<input type="button" value="rate -.5" onclick="timelapse_set_playback_rate(-.5)">
<input type="button" value="rate -.25" onclick="timelapse_set_playback_rate(-.25)">
<input type="button" value="rate -.1" onclick="timelapse_set_playback_rate(-.1)">
<input type="button" value="rate .1" onclick="timelapse_set_playback_rate(.1)">
<input type="button" value="rate .25" onclick="timelapse_set_playback_rate(.25)">
<input type="button" value="rate .5" onclick="timelapse_set_playback_rate(.5)">
<input type="button" value="rate 1" onclick="timelapse_set_playback_rate(1)">

<div id="mouse_debug_info">
   <span class="label">Window Coords:</span> <span id="window_coords"></span><br>
   <span class="label">Viewer Pixel Coords:</span> <span id="viewer_pixel_coords"></span><br>
   <span class="label">Viewer Pano Coords:</span> <span id="viewer_pano_coords"></span><br>
   <span class="label">Viewer Bounds:</span> <span id="viewer_bounds"></span><br>
</div>

<br>Debug:
<input id="logVideoStatus" type="checkbox" onclick="timelapse_log_status(this.value)"><label for="logVideoStatus">Log video status</label>
<input id="showNativeVideoControls" type="checkbox" onclick="timelapse_enable_native_video_controls(this.value)"><label for="showNativeVideoControls">Show Native Video Controls</label>

<table border="0" cellpadding="3" cellspacing="0" class="control_panel_widget">
   <tr>
   	  <td>
   	  	<div id="play_toggle" class="play" title="Play"></div>
   	  </td>
   	  <td>
   	  	<div id="stop" class="stop" title="Stop"></div>
   	  </td>
      <td colspan="3">
         <div id="timelineSlider"></div>
      </td>
      <td align="right">
         <span id="currentTime">00:00:00</span> <span id="totalTime">00:00:00</span><br>
      </td>
   </tr>
</table>

</body>
</html>
